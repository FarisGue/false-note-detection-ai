"""Pydantic model representing the result of a false note analysis."""

from pydantic import BaseModel, Field
from typing import List, Optional, Dict, Any


class AnalysisResult(BaseModel):
    """Response model for an analysis request."""

    total_frames: int = Field(..., description="Total number of frames analyzed")
    correct_frames: int = Field(..., description="Number of frames with correct pitch")
    incorrect_frames: int = Field(..., description="Number of frames with incorrect pitch")
    mean_cents: float = Field(..., description="Mean absolute pitch deviation in cents")
    max_cents: float = Field(..., description="Maximum absolute pitch deviation in cents")
    accuracy_percent: float = Field(..., description="Accuracy percentage (0-100)")
    error_indices: List[int] = Field(..., description="Frame indices where errors were detected")
    duration_seconds: float = Field(..., description="Duration of the analysis in seconds")
    threshold_cents: float = Field(..., description="Threshold used for error detection in cents")
    # Optional: sampled pitch data for visualization (to keep response size manageable)
    pitch_data: Optional[Dict[str, Any]] = Field(
        None, 
        description="Sampled pitch frequencies for visualization (audio and reference)"
    )

    # Optional practice recommendations generated by a language model. If the
    # server is configured with a valid OpenRouter API key and the client
    # requests recommendations, this field will contain natural language
    # feedback on how to improve the performance. Otherwise it will be None.
    recommendations: Optional[str] = Field(
        None,
        description="Practice recommendations generated by a language model",
    )